{
  "_format": "hh3-sol-build-info-1",
  "id": "solc-0_8_30-72af41111d37686849460e5b2734b5034d7e5dbe",
  "solcVersion": "0.8.30",
  "solcLongVersion": "0.8.30+commit.73712a01",
  "userSourceNameMap": {
    "contracts/ProducerRegistry.sol": "project/contracts/ProducerRegistry.sol"
  },
  "input": {
    "language": "Solidity",
    "settings": {
      "evmVersion": "prague",
      "optimizer": {
        "enabled": true,
        "runs": 200
      },
      "outputSelection": {
        "*": {
          "": [
            "ast"
          ],
          "*": [
            "abi",
            "evm.bytecode",
            "evm.deployedBytecode",
            "evm.methodIdentifiers",
            "metadata"
          ]
        }
      },
      "remappings": []
    },
    "sources": {
      "project/contracts/ProducerRegistry.sol": {
        "content": "// SPDX-License-Identifier: MIT\npragma solidity 0.8.30;\n\ncontract ProducerRegistry {\n    address public admin;\n\n    enum Status { None, Pending, Approved, Rejected }\n\n    struct Producer {\n        string name;\n        string location;\n        uint256 capacity;\n        string aadhaarHash;\n        Status status;\n    }\n\n    mapping(address => Producer) public producers;\n    mapping(address => bool) public hasRequested;\n\n    address[] public pendingProducers;\n    address[] public allProducers;\n\n    event ProducerRequested(address producer);\n    event ProducerApproved(address producer);\n    event ProducerRejected(address producer);\n\n    constructor() {\n        admin = msg.sender;\n    }\n\n    modifier onlyAdmin() {\n        require(msg.sender == admin, \"Unauthorised Access\");\n        _;\n    }\n\n    modifier onlyValidStatus(address producer, Status required) {\n        require(producers[producer].status == required, \"Invalid status\");\n        _;\n    }\n\n    // Producer Request approval\n    function requestProducerApproval(\n        string memory _name,\n        string memory _location,\n        uint256 _capacity,\n        string memory _aadhaarHash\n    ) external {\n\n        Producer storage prod = producers[msg.sender];\n        require(\n            prod.status == Status.None || prod.status == Status.Rejected,\n            \"Cannot request again\"\n        );\n\n        require(_capacity > 0, \"Capacity must be greater than zero\");\n\n        require(bytes(_aadhaarHash).length > 0, \"Aadhaar hash required\");\n\n        if (prod.status == Status.None && !hasRequested[msg.sender]) {\n            allProducers.push(msg.sender);\n        }\n\n        prod.name = _name;\n        prod.location = _location;\n        prod.capacity = _capacity;\n        prod.aadhaarHash = _aadhaarHash;\n        prod.status = Status.Pending;\n\n        pendingProducers.push(msg.sender);\n        hasRequested[msg.sender] = true;\n\n        emit ProducerRequested(msg.sender);\n\n    }\n\n    // Admin approve Producer\n    function approveProducer(address producer) external onlyAdmin onlyValidStatus(producer, Status.Pending) {\n        producers[producer].status = Status.Approved;\n\n        _removePending(producer);\n        emit ProducerApproved(producer);\n    }\n\n    // Admin reject Producer\n    function rejectProducer(address producer) external onlyAdmin onlyValidStatus(producer, Status.Pending) {\n        producers[producer].status = Status.Rejected;\n\n        _removePending(producer);\n        emit ProducerRejected(producer);\n    }\n\n    //Function to remove rejected and approved producer from pending\n    function _removePending(address producer) internal {\n        if (!hasRequested[producer]) return;\n\n        hasRequested[producer] = false;\n\n        uint256 len = pendingProducers.length;\n        for (uint256 i = 0; i < len; i++) {\n            if (pendingProducers[i] == producer) {\n                pendingProducers[i] = pendingProducers[len - 1];\n                pendingProducers.pop();\n                break;\n            }\n        }\n    }\n\n    // Checking if producer is approved\n    function isApprovedProducer(address producer) external view returns (bool) {\n        return producers[producer].status == Status.Approved;\n    }\n\n    // Getting all Pending Producers\n    function getPendingProducers() external view returns (address[] memory) {\n        return pendingProducers;\n    }\n\n    // Getting all Producers\n    function getAllProducers() external view returns (address[] memory) { \n        return allProducers; \n    }\n\n    // Getting full Producer Details\n    function getProducerDetails(address producer) external view returns (\n        string memory,\n        string memory,\n        uint256,\n        string memory,\n        Status\n    ) {\n        Producer memory prod = producers[producer];\n        return (prod.name, prod.location, prod.capacity, prod.aadhaarHash, prod.status);\n    }\n\n}\n"
      }
    }
  }
}